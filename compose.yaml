services:
  yep:
    build: .
    ports:
      - "${PORT:-3400}:3400"
    volumes:
      # Persist agent auth, session history, and Yep Anywhere data
      - labrat-data:/home/labrat
      # Workspace — CLAUDE.md, .mcp.json, and working files
      - ./workspace:/home/labrat/workspace
    environment:
      # Container user UID/GID — match your host user to avoid permission issues
      - PUID=${PUID:-1000}
      - PGID=${PGID:-1000}
      # Agent API keys (at least one needed, or use OAuth for Claude)
      - ANTHROPIC_API_KEY=${ANTHROPIC_API_KEY:-}
      - CLAUDE_CODE_OAUTH_TOKEN=${CLAUDE_CODE_OAUTH_TOKEN:-}
      # Yep Anywhere web UI password (required)
      - YEP_PASSWORD=${YEP_PASSWORD}
      # Allowed hostnames for Yep Anywhere (set when behind a reverse proxy)
      - ALLOWED_HOSTS=${ALLOWED_HOSTS:-}
      # Tool and MCP server keys
      - CONTEXT7_API_KEY=${CONTEXT7_API_KEY:-}
      - BRAVE_API_KEY=${BRAVE_API_KEY:-}
      - GEMINI_API_KEY=${GEMINI_API_KEY:-}
      - GITHUB_TOKEN=${GITHUB_TOKEN:-}
    init: true
    restart: unless-stopped

volumes:
  labrat-data:
